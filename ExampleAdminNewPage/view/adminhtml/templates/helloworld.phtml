<!-- Make an HTML page for a custom chatbot for doall saws. include configurations like GPT temperature, upload pdf and connect to database: -->
<link rel="stylesheet" href="https://cdn.tailwindcss.com">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
        $(document).ready(function () {
            $('#send-btn').click(function () {
                var userText = $('#user-input').val();
                $('#user-input').val('');
                $('#chatbox').append('<p><strong>You:</strong> ' + userText + '</p>');

                // Send the user's message to the server and get the response
                $.ajax({
                    url: 'chatbot.php',
                    type: 'POST',
                    data: { 'text': userText },
                    success: function (response) {
                        var responseObj = JSON.parse(response);
                        $('#chatbox').append('<p><strong>Bot:</strong> ' + responseObj.message.content + '</p>');
                    }
                });
            });
        });
    </script>

    <?php
    // With PHP, make an api request to the chatbot on click of the submit button:


    // repo is https://github.com/openai-php/client
    echo "Hello World!";
    $yourApiKey = getenv('OPENAI_API_KEY');
    echo $yourApiKey;

    $client = OpenAI::client($yourApiKey);
    $response = $client->chat()->create([
        'model' => 'gpt-3.5-turbo',
        'messages' => [
            ['role' => 'user', 'content' => 'Hello!'],
        ],
    ]);
    
    $response->id; // 'chatcmpl-6pMyfj1HF4QXnfvjtfzvufZSQq6Eq'
    $response->object; // 'chat.completion'
    $response->created; // 1677701073
    $response->model; // 'gpt-3.5-turbo-0301'
    
    foreach ($response->choices as $result) {
        $result->index; // 0
        $result->message->role; // 'assistant'
        $result->message->content; // '\n\nHello there! How can I assist you today?'
        $result->finishReason; // 'stop'
    }
    
    $response->usage->promptTokens; // 9,
    $response->usage->completionTokens; // 12,
    $response->usage->totalTokens; // 21
    
    $response->toArray(); // ['id' => 'chatcmpl-6pMyfj1HF4QXnfvjtfzvufZSQq6Eq', ...]    
    ?>

    <h1 class="text-xl">DoAll Saws Chatbot</h1>
    
    <h2 class="text-lg">Configurations</h2>
    <p class="text-md">Here is the HTML of the above query:</p>

    <div class="chatbox" style="border:1px solid #ccc; padding:10px; margin-bottom:10px; height:200px; overflow-y:scroll;" id="chatbox">
        <!-- Chat will appear here -->
    </div>

    <input type="text" id="user-input" placeholder="Ask something...">
    <button id="send-btn">Send</button>

    <script>
        $(document).ready(function () {
            $('#send-btn').click(function () {
                var userText = $('#user-input').val();
                $('#user-input').val('');
                $('#chatbox').append('<p><strong>You:</strong> ' + userText + '</p>');

                // Send the user's message to the server and get the response
                $.ajax({
                    url: 'chatbot.php',
                    type: 'POST',
                    data: { 'text': userText },
                    success: function (response) {
                        var responseObj = JSON.parse(response);
                        $('#chatbox').append('<p><strong>Bot:</strong> ' + responseObj.message.content + '</p>');
                    }
                });
            });
        });
    </script>

    <!-- add an upload link -->
    <input type="file" id="myFile" name="filename">
    <!-- With tailwinds, add a temperature slider -->
    <div class="w-full">
        <label for="temperature" class="block text-lg font-medium text-gray-700">Temperature</label>
        <div class="mt-1">
            <input type="range" name="temperature" id="temperature" class="focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
        <!-- send an api request -->
        <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700">Send</button>
    </div>
    <!-- add a chatbot -->
    <div class="w-full">
        <label for="chatbot" class="block text-sm font-medium text-gray-700">Chatbot</label>
        <div class="mt-1">
            <input type="text" name="chatbot" id="chatbot" class="focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
    </div>
    <!-- add a database connection -->
    <div class="w-full">
        <label for="database" class="block text-sm font-medium text-gray-700">Database</label>
        <div class="mt-1">
            <input type="text" name="database" id="database" class="focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
    </div>
    <!-- add a pdf upload -->
    <div class="w-full">
        <label for="pdf" class="block text-sm font-medium text-gray-700">PDF</label>
        <div class="mt-1">
            <input type="file" name="pdf" id="pdf" class="focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
        </div>
    </div>
    <!-- add a submit button -->
    <button type="submit" id="chatbot-submit" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700">Submit</button>
    <!-- add a reset button -->
    <button type="reset" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700">Reset</button>
    <!-- add a cancel button -->
    <button type="cancel" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700">Cancel</button>
    <!-- add a save button -->